"use strict";(self["webpackChunkvue_cread"]=self["webpackChunkvue_cread"]||[]).push([[578],{7578:function(t,s,e){e.r(s),e.d(s,{default:function(){return u}});var n=function(){var t=this,s=t._self._c;return t.topic?s("div",{staticClass:"topic"},[s("base-panel",{scopedSlots:t._u([{key:"panel-content",fn:function(){return[s("div",{staticClass:"topic-head"},[s("div",{staticClass:"head-top"},[t.topic.top||t.topic.good?s("el-tag",{attrs:{size:"small",type:"success",effect:"dark"}},[t._v(t._s(t.topic.top?"置顶":"精华"))]):s("el-tag",{attrs:{size:"small",type:"info"}},[t._v(t._s(t._f("tabTextTransform")(t.topic.tab)))]),s("h3",[t._v(t._s(t.topic.title))]),t.accesstoken?s("el-button",{staticClass:"scyqx",attrs:{type:"success"},on:{click:t.collect}},[t._v(t._s(t.topic.is_collect?"取消收藏":"收藏"))]):t._e()],1),s("p",[s("span",{staticClass:"iconfont icon-dian dics"}),s("span",[t._v("发布于"+t._s(t._f("fromNow")(t.topic.create_at)))]),s("span",{staticClass:"iconfont icon-dian"}),s("span",[t._v("作者"+t._s(t.topic.author.loginname))]),s("span",{staticClass:"iconfont icon-dian dics"}),s("span",[t._v(t._s(t.topic.visit_count)+"次浏览")]),s("span",{staticClass:"iconfont icon-dian dics"}),s("span",[t._v("来自"+t._s(t._f("tabTextTransform")(t.topic.tab)))])])]),s("div",{staticClass:"toppic-content",domProps:{innerHTML:t._s(t.topic.content)}})]},proxy:!0}],null,!1,938322223)}),t.topic.replies.length?s("base-panel",{scopedSlots:t._u([{key:"panel-head",fn:function(){return[s("div",{staticClass:"comment-head"},[s("span",[s("span",[t._v(t._s(t.topic.replies.length))]),t._v(" 回复")])])]},proxy:!0},{key:"panel-content",fn:function(){return[s("div",{staticClass:"comment-list"},t._l(t.topic.replies,(function(e,n){return s("div",{key:e.id,staticClass:"comment-item",class:["comment-time",{active:t.commentLikeMost.includes(e.id)}]},[s("router-link",{attrs:{to:`/user/${e.author.loginname}`}},[s("img",{attrs:{src:e.author.avatar_url,alt:""}})]),s("div",{staticClass:"comment-content"},[s("span",{staticClass:"info"},[s("span",[t._v(" "+t._s(e.author.loginname)+" "+t._s(n+1)+"楼 "),s("span",{staticClass:"iconfont icon-dian dics"}),t._v(" "+t._s(t._f("fromNow")(e.create_at))+" ")]),t.accesstoken||e.ups.length?s("span",{staticClass:"like"},[s("span",{class:["icon-zan1","iconfont",{up:e.is_uped}],on:{click:function(s){return t.like(e)}}}),e.ups.length?s("span",[t._v(t._s(e.ups.length))]):t._e()]):t._e()]),s("span",{staticClass:"text",domProps:{innerHTML:t._s(e.content)}})])],1)})),0)]},proxy:!0}],null,!1,892341890)}):t._e(),t.accesstoken?s("BasePanel",{scopedSlots:t._u([{key:"panel-head",fn:function(){return[t._v("添加评论")]},proxy:!0},{key:"panel-content",fn:function(){return[s("div",{staticClass:"markdown-container"},[s("div",{staticClass:"container"},[s("mavon-editor",{ref:"md",staticStyle:{"min-height":"400px"},model:{value:t.commenText,callback:function(s){t.commenText="string"===typeof s?s.trim():s},expression:"commenText"}}),s("el-button",{staticClass:"editor-btn",attrs:{type:"primary"},on:{click:t.reply}},[t._v("提交")])],1)])]},proxy:!0}],null,!1,2286216473)}):t._e()],1):t._e()},i=[],c=(e(7658),e(9969)),o=e(3150),a={components:{BasePanel:c.Z},props:["topicId"],data(){return{topic:null,accesstoken:"",commenText:"",markdownOption:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,code:!0,table:!0,fullscreen:!0,readmodel:!0,htmlcode:!0,help:!0,undo:!0,redo:!0,trash:!0,save:!0,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!0,preview:!0}}},computed:{commentLikeMost(){if(0===this.topic.replies.length)return[];const t=this.topic.replies.slice(0).sort(((t,s)=>s.ups.length-t.ups.length)),s=[],e=t[0].ups.length;if(e>2){const n=t.filter((t=>t.ups.length===e));n.forEach((t=>{s.push(t.id)}));const i=t[n.length].ups.length;if(i>2){const e=t.filter((t=>t.ups.length===i));e.forEach((t=>{s.push(t.id)}))}}return s}},async created(){const t=sessionStorage.getItem("accesstoken");t&&(this.accesstoken=t);const s=await(0,o.BN)(this.topicId,t||null);this.topic=s.data},methods:{async collect(){const t=this.accesstoken;this.topic.is_collect?(await(0,o.uk)(this.topic.id,t),this.topic.is_collect=!1):(await(0,o.dA)(this.topic.id,t),this.topic.is_collect=!0)},async like(t){const s=this.accesstoken;if(s){const e=await(0,o.vo)(t.id,s),n=JSON.parse(sessionStorage.getItem("userInfo")).id;"up"===e.action?(t.is_uped=!0,t.ups.push(n)):(t.is_uped=!1,t.ups=t.ups.filter((t=>t!==n)))}},async reply(){const{commenText:t,accesstoken:s,topic:e}=this;if(t){await(0,o.ts)(e.id,s,t);const n=await(0,o.BN)(this.topicId,s);this.topic=n.data,this.commenText=""}}}},l=a,p=e(1001),r=(0,p.Z)(l,n,i,!1,null,null,null),u=r.exports}}]);
//# sourceMappingURL=578.eca6a0ab.js.map